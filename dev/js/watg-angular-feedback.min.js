/*! watg-angular-feedback 2016-10-07 */
!function(){"use strict";angular.module("watgFeedbackModule",["ngRoute","watgFeedbackModule.const","watgRichtext","watgFileuploadModule"])}(),angular.module("watgFeedbackModule.const",[]).constant("CONST_WATGXRESTAPIURL","http://10.10.9.97/watgxapirest/api").constant("CONST_RESOURCEURL","http://10.10.9.97:8080").constant("CONST_LOGSENABLED",!0),function(){"use strict";function appConfig($routeProvider,$httpProvider){$httpProvider.defaults.useXDomain=!0,delete $httpProvider.defaults.headers.common["X-Requested-With"],$httpProvider.defaults.headers.get||($httpProvider.defaults.headers.get={}),$httpProvider.defaults.headers.get["If-Modified-Since"]="Mon, 26 Jul 1997 05:00:00 GMT",$routeProvider.when("/test",{templateUrl:"src/app/tests/watgFeedbackTestView.html",controller:"watgFeedbackTestController"}).otherwise({redirectTo:"/test"})}function appRun(){}var app=angular.module("watgFeedbackModule");app.config(["$routeProvider","$httpProvider",appConfig]),app.run(appRun)}(),function(){"use strict";function watgFeedbackTestController($scope,$window,CONST_WATGXRESTAPIURL){$scope.header="Feedback";var feedbackServiceLocation=CONST_WATGXRESTAPIURL+"/Feedback/";$scope.maxAttachmentSize=1048576,$scope.maxNumberOfAttachments=2,$scope.getAppDevProjectByProjectNameUrl=feedbackServiceLocation+"GetAppDevProjectByProjectName",$scope.submitAppDevProjectFeedbackUrl=feedbackServiceLocation+"SubmitAppDevProjectFeedback",$scope.user={FullName:"Tolga Koseoglu"},console.log(navigator.vendor),navigator.appCodeName,navigator.appName,navigator.appMinorVersion,navigator.cpuClass,navigator.platform,navigator.plugins,navigator.opsProfile,navigator.userProfile,navigator.systemLanguage,navigator.userLanguage,navigator.appVersion,navigator.userAgent,navigator.onLine,navigator.cookieEnabled,navigator.mimeTypes;for(var p in navigator)console.log(p),console.log(navigator[p])}angular.module("watgFeedbackModule").controller("watgFeedbackTestController",["$scope","$window","CONST_WATGXRESTAPIURL",watgFeedbackTestController])}(),function(){"use strict";function watgFeedback(){return{restrict:"E",templateUrl:"src/app/directives/templates/watgFeedbackTemplate.html",scope:{projectName:"=",getUrl:"=",submitUrl:"=",userFullName:"=",urlReferrer:"=",logsEnabled:"=?",feedbackInputHeight:"=?",feedbackMaxNumberOfAttachments:"=?",feedbackAttachmentMaxSize:"=?",feedbackAttachmentImageMaxHeight:"=?",feedbackAttachmentImageMaxWidth:"=?"},controller:controller,link:function(scope){scope.feedbackInputHeight||(scope.feedbackInputHeight=100),scope.feedbackAttachmentMaxSize||(scope.feedbackAttachmentMaxSize=2097152),scope.feedbackAttachmentImageMaxHeight||(scope.feedbackAttachmentImageMaxHeight=1e3),scope.feedbackAttachmentImageMaxWidth||(scope.feedbackAttachmentImageMaxWidth=1e3),scope.feedbackMaxNumberOfAttachments||(scope.feedbackMaxNumberOfAttachments=5),scope.logsEnabled||(scope.logsEnabled=!0),scope.logsEnabled&&(console.log(scope.projectName),console.log(scope.getUrl),console.log(scope.submitUrl),console.log(scope.userFullName),console.log(scope.urlReferrer))}}}angular.module("watgFeedbackModule").directive("watgFeedback",watgFeedback);var controller=["$scope","watgFeedbackService",function($scope,watgFeedbackService){function updateStars(){$scope.stars=[];for(var i=0;i<$scope.max;i++)$scope.stars.push({filled:i<$scope.ratingValue})}$scope.header="Feedback",$scope.isBusySubmittingFeedback=!1,$scope.showConfirmation=!1,$scope.form={},$scope.max=5,$scope.stars=[],$scope.ratingValue=0,$scope.feebackContentResetCount=[],$scope.feedbackRichtextConfig={height:$scope.feedbackInputHeight,multiLine:!0,bootstrapCssPath:"public/css/vendor.min.css",showVariablesSelector:!0,showFontSelector:!0,showFontSizeSelector:!0,showColorSelector:!0,showBold:!0,showItalic:!0,showStrikeThrough:!0,showUnderline:!0,showUnorderedList:!0,showOrderedList:!0,showReduceIndent:!0,showIndent:!0,showLeftAlign:!0,showCenterAlign:!0,showRightAlign:!0,showJustify:!0,showUndo:!0,showRedo:!0,showInsertLink:!0,showRemoveLink:!0,showSourceCode:!1},$scope.attachmentUploadIsBusy=!1,$scope.attachmentUploadMessages=[],$scope.appDevProjectUI={AppDevProjectId:0,AppDevProjectName:"",AppDevProjectDescription:"",AppDevProjectVersion:"",FeedbackContent:"",Vendor:"",Platform:"",UserAgent:"",ScreenResolution:"",Rating:null,Files:[]},$scope.getAppDevProjectByProjectName=function(){$scope.isBusy=!0,watgFeedbackService.getAppDevProjectByProjectName($scope.getUrl+"/"+$scope.projectName).then(function(result){$scope.appDevProjectUI.AppDevProjectId=result.AppDevProjectId,$scope.appDevProjectUI.AppDevProjectName=result.AppDevProjectName,$scope.appDevProjectUI.AppDevProjectDescription=result.AppDevProjectDescription,$scope.appDevProjectUI.AppDevProjectVersion=result.AppDevProjectVersion,$scope.isBusy=!1})},$scope.submitAppDevProjectFeedback=function(){$scope.isBusySubmittingFeedback=!0,$scope.appDevProjectUI.Vendor=navigator.vendor,$scope.appDevProjectUI.Platform=navigator.platform,$scope.appDevProjectUI.UserAgent=navigator.userAgent,$scope.appDevProjectUI.ScreenResolution=window.screen.availWidth+"*"+window.screen.availHeight,$scope.appDevProjectUI.Rating=$scope.ratingValue,$scope.urlReferrer&&($scope.appDevProjectUI.FeedbackContent+="<br />(Previous page) "+$scope.urlReferrer),watgFeedbackService.submitAppDevProjectFeedback($scope.appDevProjectUI,$scope.submitUrl).then(function(result){console.log(result);var transactionResult=result;transactionResult.HasError===!0&&console.error("Feedback Error "+transactionResult.Message),$scope.showConfirmation=!0,$scope.isBusySubmittingFeedback=!1})},$scope.toggle=function(index){$scope.ratingValue=index+1},$scope.$watch("ratingValue",function(oldValue){oldValue&&updateStars()}),$scope.$watch("projectName",function(oldValue,newValue){newValue&&$scope.getAppDevProjectByProjectName()}),$scope.$watch("appDevProjectUI.FeedbackContent",function(newValue){""===newValue||"<br>"===newValue?$scope.form.inputForm.$setValidity("message",!1):$scope.form.inputForm.$setValidity("message",!0)}),$scope.$watchCollection("appDevProjectUI.Files",function(newValue,oldValue){$scope.attachmentUploadMessages=[]}),$scope.getAppDevProjectByProjectName(),updateStars()}]}(),function(){"use strict";function watgFeedbackService($http){return{getAppDevProjectByProjectName:function(url){return console.log(url),$http({method:"GET",withCredentials:!0,url:url}).then(function(response){return response.data})},submitAppDevProjectFeedback:function(vm,url){console.log("Service 2 "+url);var formData=new FormData;formData.append("FeedbackContent",vm.FeedbackContent),formData.append("Vendor",vm.Vendor),formData.append("Platform",vm.Platform),formData.append("UserAgent",vm.UserAgent),formData.append("ScreenResolution",vm.ScreenResolution),formData.append("Rating",vm.Rating),formData.append("AppDevProjectId",vm.AppDevProjectId);for(var i=0;i<vm.Files.length;i++)formData.append("Files["+i+"]",vm.Files[i]);return $http({url:url,method:"POST",transformRequest:angular.identity,data:formData,withCredentials:!0,headers:{"Content-Type":void 0}}).then(function(response){return console.timeEnd("Posting Note"),response.data})}}}angular.module("watgFeedbackModule").factory("watgFeedbackService",["$http",watgFeedbackService])}();